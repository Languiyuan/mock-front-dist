import{r as L,g as M,f as q,a as P}from"./user-De565Ul_.js";import{d as U,r as m,a as A,b as o,c as h,n as z,w as s,g as p,f as t,h as u,i as G,s as D,q as H,o as J,e as K,D as O,F as Q,G as W,x as S,t as B}from"./index-7IicHMeD.js";import"./login-CKbHa5S2.js";const X={class:"dialog-footer"},Y=U({__name:"RegisterDialog",emits:["success"],setup(N,{expose:x,emit:_}){const g=_,i=m(),n=A({username:"",password:"123456",isAdmin:!1}),r=A({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:10,message:"用户名长度在10字符串以内",trigger:"blur"}]}),f=m(!1),k=()=>{f.value=!0},v=()=>{i.value&&i.value.resetFields(),f.value=!1},V=d=>{d&&d.validate(async e=>{e&&(await y(),g("success"),v())})},y=async()=>{const{data:d}=await L(n);D.success(d)};return x({openDialog:k}),(d,e)=>{const a=o("el-input"),C=o("el-form-item"),b=o("el-button"),F=o("el-dialog");return h(),z(F,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=c=>f.value=c),title:"添加用户",width:"500px","before-close":v,draggable:""},{footer:s(()=>[p("span",X,[t(b,{onClick:v},{default:s(()=>[u("取消")]),_:1}),t(b,{type:"primary",onClick:e[1]||(e[1]=c=>V(i.value))},{default:s(()=>[u("确认")]),_:1})])]),default:s(()=>[t(G(H),{ref_key:"usernameFormRef",ref:i,model:n,rules:r,size:"large"},{default:s(()=>[t(C,{prop:"username"},{default:s(()=>[t(a,{modelValue:n.username,"onUpdate:modelValue":e[0]||(e[0]=c=>n.username=c),placeholder:"请输入用户名 note:默认密码 123456",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),Z={class:"bg-white h-full pt-4"},ee={class:"w-full h-12 pl-4 pr-4 flex items-center justify-between"},te={class:"h-full flex items-center"},ae={class:"h-full flex items-center"},le={class:"h-[calc(100%_-_48px_-_48px)] pl-4 pr-4"},se={class:"w-full h-12 flex items-center justify-end pr-4"},re=U({__name:"index",setup(N){J(()=>{r()});const x=m([]),_=m(!1),g=m(""),i=m(""),n=A({total:0,pageNo:1,pageSize:20}),r=async()=>{const e={username:g.value,pageNo:n.pageNo,pageSize:n.pageSize};typeof i.value=="boolean"&&(e.isAdmin=i.value),_.value=!0;try{const{data:a}=await M(e);x.value=a.list,n.total=a.total,_.value=!1}catch{_.value=!1}},f=async e=>{B.confirm("请确认是否冻结该账户","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{await k(e.id),await r()}).catch(()=>{})},k=async e=>{const{data:a}=await q({userId:e});D.success(a)},v=async e=>{B.confirm("请确认是否解冻该账户","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{await V(e.id),await r()}).catch(()=>{})},V=async e=>{const{data:a}=await P({userId:e});D.success(a)},y=m(),d=()=>{y.value&&y.value.openDialog()};return(e,a)=>{const C=o("el-input"),b=o("el-option"),F=o("el-select"),c=o("el-button"),w=o("el-table-column"),R=o("el-tag"),$=o("el-empty"),T=o("el-table"),j=o("el-pagination"),E=W("loading");return h(),K(Q,null,[p("div",Z,[p("div",ee,[p("div",te,[t(C,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=l=>g.value=l),style:{width:"240px"},class:"pr-4",placeholder:"名称",clearable:""},null,8,["modelValue"]),t(F,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=l=>i.value=l),style:{width:"240px"},class:"pr-4",placeholder:"角色",clearable:""},{default:s(()=>[t(b,{label:"管理员",value:!0}),t(b,{label:"普通成员",value:!1})]),_:1},8,["modelValue"]),t(c,{type:"primary",icon:"Search",onClick:r},{default:s(()=>[u("查询")]),_:1})]),p("div",ae,[t(c,{type:"primary",icon:"Plus",onClick:d},{default:s(()=>[u("添加")]),_:1})])]),p("div",le,[O((h(),z(T,{data:x.value,height:"100%",style:{width:"100%"},border:!0,"header-row-class-name":"user-header-row-class-name"},{empty:s(()=>[t($,{description:"暂无数据"})]),default:s(()=>[t(w,{type:"index",label:"序号",width:"80"}),t(w,{prop:"username",label:"名称"}),t(w,{prop:"isAdmin",label:"角色"},{default:s(l=>[u(S(l.row.isAdmin?"管理员":"普通成员"),1)]),_:1}),t(w,{prop:"isFrozen",label:"状态"},{default:s(l=>[t(R,{type:l.row.isFrozen?"danger":"success",effect:"dark"},{default:s(()=>[u(S(l.row.isFrozen?"已冻结":"正常"),1)]),_:2},1032,["type"])]),_:1}),t(w,{label:"操作",width:"200"},{default:s(l=>[l.row.isFrozen?(h(),z(c,{key:1,link:"",type:"primary",size:"small",disabled:l.row.isAdmin,onClick:I=>v(l.row)},{default:s(()=>[u(" 解冻 ")]),_:2},1032,["disabled","onClick"])):(h(),z(c,{key:0,link:"",type:"primary",size:"small",disabled:l.row.isAdmin,onClick:I=>f(l.row)},{default:s(()=>[u(" 冻结 ")]),_:2},1032,["disabled","onClick"]))]),_:1})]),_:1},8,["data"])),[[E,_.value]])]),p("div",se,[t(j,{"current-page":n.pageNo,"onUpdate:currentPage":a[2]||(a[2]=l=>n.pageNo=l),"page-size":n.pageSize,"onUpdate:pageSize":a[3]||(a[3]=l=>n.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:n.total,onSizeChange:r,onCurrentChange:r},null,8,["current-page","page-size","total"])])]),t(Y,{ref_key:"RegisterDialogRef",ref:y,onSuccess:r},null,512)],64)}}});export{re as default};
