import{d as q,v as te,B as A,r as d,a as S,n as z,w as l,b as s,c as w,g as c,f as e,h as $,s as E,_ as N,o as T,C as oe,e as D,D as le,u as ae,G as se,F as ne,y as re,x as V,H as F,i as I,t as ie}from"./index-BsoPr0S2.js";import{a as ce,e as de,p as ue,d as pe}from"./project-D5p_IelN.js";import{f as M}from"./index-Ck4Kn7K7.js";import"./login-D-CZcHGF.js";const _e={class:"dialog-footer"},me=q({__name:"AddProjectDialog",props:{info:{},type:{}},emits:["success"],setup(L,{expose:U,emit:C}){const p=L,g=C,b=te(()=>p.type==="add"?"新增项目":"编辑项目");A(()=>p.info,()=>{if(p.info){const{name:v,baseUrl:t,description:r}=p.info;a.name=v,a.baseUrl=t,a.description=r}},{deep:!0});const f=d(!1),m=d(),a=S({name:"",baseUrl:"",description:""}),h=S({name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:3,max:150,message:"长度 3 到 150",trigger:"blur"}],baseUrl:[{required:!0,message:"请输入接口基础路径",trigger:"blur"},{min:3,max:150,message:"长度 3 到 150",trigger:"blur"},{validator:(v,t,r)=>{/^\/[a-zA-Z0-9/]+$/.test(t)?r():r(new Error("请输入正确格式的baseUrl"))},trigger:"blur"}],description:[{required:!0,message:"请输入项目描述",trigger:"blur"}]}),k=()=>{f.value=!0},x=()=>{m.value&&m.value.resetFields(),f.value=!1},P=()=>{var v;(v=m.value)==null||v.validate(async t=>{var r;if(t){if(p.type==="add"){const{data:i}=await ce(a);E.success(i)}else{const{data:i}=await de({...a,projectId:((r=p.info)==null?void 0:r.id)||-1});E.success(i)}x(),g("success")}})};return U({open:k}),(v,t)=>{const r=s("el-input"),i=s("el-form-item"),j=s("el-form"),o=s("el-button"),_=s("el-dialog");return w(),z(_,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=u=>f.value=u),title:b.value,width:"500","before-close":x},{footer:l(()=>[c("div",_e,[e(o,{onClick:x},{default:l(()=>[$("取消")]),_:1}),e(o,{type:"primary",onClick:P},{default:l(()=>[$(" 确认 ")]),_:1})])]),default:l(()=>[e(j,{ref_key:"addProjectFormRef",ref:m,model:a,rules:h},{default:l(()=>[e(i,{prop:"name",label:"项目名称"},{default:l(()=>[e(r,{modelValue:a.name,"onUpdate:modelValue":t[0]||(t[0]=u=>a.name=u)},null,8,["modelValue"])]),_:1}),e(i,{prop:"baseUrl",label:"接口基础路径"},{default:l(()=>[e(r,{modelValue:a.baseUrl,"onUpdate:modelValue":t[1]||(t[1]=u=>a.baseUrl=u),placeholder:"example: /test"},null,8,["modelValue"])]),_:1}),e(i,{prop:"description",label:"项目描述"},{default:l(()=>[e(r,{modelValue:a.description,"onUpdate:modelValue":t[2]||(t[2]=u=>a.description=u),rows:4,type:"textarea",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),fe=N(me,[["__scopeId","data-v-a7960af0"]]),ve={ref:"projectContainer",class:"w-full h-full overflow-hidden"},ge={class:"relative flex items-center justify-between"},be={class:"absolute top-0 right-0 flex items-center"},he={class:"h-[calc(100%_-_40px)] pt-4 scrollbar-container"},xe={class:"flex items-center"},we={class:"flex-1 text-e text-[18px] font-bold"},ye=["title"],je={class:"min-h-28"},Ve=["title"],Ue=["title"],Ce=["title"],ke={class:"flex items-center"},Pe=["onClick"],Be=["onClick"],De=q({__name:"index",setup(L){const U=d("top"),C=ae(),p=d(!1),g=d("all"),b=d([]),f=d([]),m=async()=>{try{p.value=!0,b.value=[],f.value=[];const{data:o}=await ue({type:g.value});b.value=o,f.value=o}finally{p.value=!1}};T(()=>{m()}),A(()=>g.value,()=>{t.value="",m()});const a=d("add"),y=d(null),h=d(),k=()=>{a.value="add",y.value=null,h.value.open()},x=o=>{a.value="eidt",y.value=o,h.value.open()},P=async o=>{const{data:_}=await pe({projectId:o});E({type:"success",message:_})},v=o=>{const _=new RegExp(`^${o.name}$`);ie.prompt("请输入·项目名称·确认删除(项目所有数据将被删除)","删除项目",{confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:_,inputErrorMessage:"项目名称错误"}).then(async()=>{await P(o.id),await m()}).catch(()=>{})},t=d("");A(t,()=>{b.value=f.value.filter(o=>o.name.includes(t.value)||o.baseUrl.includes(t.value))});const r=o=>{C.push({path:`/apiList/${o.id}`})},i=d(6);T(()=>{window.addEventListener("resize",j)}),oe(()=>{window.removeEventListener("resize",j)});const j=()=>{window.innerWidth>1100?i.value=6:window.innerWidth<=1100&&window.innerWidth>=750?i.value=8:i.value=12};return(o,_)=>{const u=s("el-tab-pane"),W=s("el-tabs"),G=s("el-input"),H=s("el-button"),Z=s("ArrowRight"),B=s("el-icon"),J=s("Delete"),K=s("Setting"),O=s("el-card"),Q=s("el-col"),X=s("el-row"),Y=se("loading");return w(),D("div",ve,[c("div",ge,[e(W,{modelValue:g.value,"onUpdate:modelValue":_[0]||(_[0]=n=>g.value=n),"tab-position":U.value,class:"w-full h-10"},{default:l(()=>[e(u,{label:"所有项目",name:"all"}),e(u,{label:"我创建的",name:"create"}),e(u,{label:"我加入的",name:"join"})]),_:1},8,["modelValue","tab-position"]),c("div",be,[e(G,{modelValue:t.value,"onUpdate:modelValue":_[1]||(_[1]=n=>t.value=n),class:"!w-72 mr-5",placeholder:"请输入项目名称或baseUrl","suffix-icon":"Search"},null,8,["modelValue"]),e(H,{type:"primary",onClick:k},{default:l(()=>[$("新增项目")]),_:1})])]),le((w(),D("div",he,[e(X,{gutter:20},{default:l(()=>[(w(!0),D(ne,null,re(b.value,(n,ee)=>(w(),z(Q,{span:i.value,key:"project"+ee},{default:l(()=>[e(O,{class:"min-w-48 mb-5 cursor-pointer hover:translate-y-[-0.5rem]",shadow:"hover",onClick:R=>r(n)},{header:l(()=>[c("div",xe,[c("div",we,[c("span",{title:n.name},V(n.name),9,ye)]),e(B,null,{default:l(()=>[e(Z)]),_:1})])]),footer:l(()=>[c("div",ke,[c("div",{class:"h-12 text-base flex-1 flex items-center justify-center hover:bg-gray-100",onClick:F(R=>v(n),["stop"])},[e(B,null,{default:l(()=>[e(J)]),_:1})],8,Pe),c("div",{class:"h-12 text-base flex-1 flex items-center justify-center hover:bg-gray-100",onClick:F(R=>x(n),["stop"])},[e(B,null,{default:l(()=>[e(K)]),_:1})],8,Be)])]),default:l(()=>[c("div",je,[c("p",{class:"text-e pb-1",title:n.baseUrl},V(n.baseUrl),9,Ve),c("p",{class:"text-e pb-1",title:I(M)(n.createTime)},V(I(M)(n.createTime)),9,Ue),c("p",{class:"line-clamp-2 pb-1",title:n.description},V(n.description),9,Ce)])]),_:2},1032,["onClick"])]),_:2},1032,["span"]))),128))]),_:1})])),[[Y,p.value]]),e(fe,{ref_key:"addProjectDialog",ref:h,type:a.value,info:y.value,onSuccess:m},null,8,["type","info"])],512)}}}),Re=N(De,[["__scopeId","data-v-111b73f6"]]);export{Re as default};
