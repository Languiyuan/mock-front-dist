import{d as z,v as oe,B as $,r as d,a as T,n as U,w as l,b as a,c as b,g as c,f as e,h as E,s as L,_ as N,o as F,C as le,e as A,D as ae,u as se,G as ne,F as re,y as ie,x as V,H as I,i as M,t as ce}from"./index---7gMHqR.js";import{a as de,e as ue,p as pe,d as _e}from"./project-DvMBX85k.js";import{f as q}from"./index-BK0zn51c.js";import"./login-CgdItC9c.js";const me={class:"dialog-footer"},fe=z({__name:"AddProjectDialog",props:{info:{},type:{}},emits:["success"],setup(R,{expose:k,emit:C}){const p=R,h=C,g=oe(()=>p.type==="add"?"新增项目":"编辑项目");$(()=>p.info,()=>{if(p.info){const{name:v,baseUrl:t,description:r}=p.info;s.name=v,s.baseUrl=t,s.description=r}},{deep:!0});const f=d(!1),m=d(),s=T({name:"",baseUrl:"",description:""}),x=T({name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:3,max:150,message:"长度 3 到 150",trigger:"blur"}],baseUrl:[{required:!0,message:"请输入接口基础路径",trigger:"blur"},{min:3,max:150,message:"长度 3 到 150",trigger:"blur"},{validator:(v,t,r)=>{/^\/[a-zA-Z0-9/]+$/.test(t)?r():r(new Error("请输入正确格式的baseUrl"))},trigger:"blur"}],description:[{required:!0,message:"请输入项目描述",trigger:"blur"}]}),P=()=>{f.value=!0},w=()=>{m.value&&m.value.resetFields(),f.value=!1},B=()=>{var v;(v=m.value)==null||v.validate(async t=>{var r;if(t){if(p.type==="add"){const{data:i}=await de(s);L.success(i)}else{const{data:i}=await ue({...s,projectId:((r=p.info)==null?void 0:r.id)||-1});L.success(i)}w(),h("success")}})};return k({open:P}),(v,t)=>{const r=a("el-input"),i=a("el-form-item"),j=a("el-form"),o=a("el-button"),_=a("el-dialog");return b(),U(_,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=u=>f.value=u),title:g.value,width:"500","before-close":w},{footer:l(()=>[c("div",me,[e(o,{onClick:w},{default:l(()=>[E("取消")]),_:1}),e(o,{type:"primary",onClick:B},{default:l(()=>[E(" 确认 ")]),_:1})])]),default:l(()=>[e(j,{ref_key:"addProjectFormRef",ref:m,model:s,rules:x},{default:l(()=>[e(i,{prop:"name",label:"项目名称"},{default:l(()=>[e(r,{modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=u=>s.name=u)},null,8,["modelValue"])]),_:1}),e(i,{prop:"baseUrl",label:"接口基础路径"},{default:l(()=>[e(r,{modelValue:s.baseUrl,"onUpdate:modelValue":t[1]||(t[1]=u=>s.baseUrl=u),placeholder:"example: /test"},null,8,["modelValue"])]),_:1}),e(i,{prop:"description",label:"项目描述"},{default:l(()=>[e(r,{modelValue:s.description,"onUpdate:modelValue":t[2]||(t[2]=u=>s.description=u),rows:4,type:"textarea",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),ve=N(fe,[["__scopeId","data-v-a7960af0"]]),ge={ref:"projectContainer",class:"w-full h-full overflow-hidden"},be={class:"relative flex items-center justify-between"},he={class:"absolute top-0 right-0 flex items-center"},xe={class:"h-[calc(100%_-_40px)] pt-4 scrollbar-container"},we={class:"flex items-center"},ye={class:"flex-1 text-e text-[18px] font-bold"},je=["title"],Ve={class:"min-h-28"},Ue=["title"],ke=["title"],Ce=["title"],Pe={class:"flex items-center"},Be=["onClick"],De=["onClick"],Ae=z({__name:"index",setup(R){const k=d("top"),C=se(),p=d(!1),h=d("all"),g=d([]),f=d([]),m=async()=>{try{p.value=!0,g.value=[],f.value=[];const{data:o}=await pe({type:h.value});g.value=o,f.value=o}finally{p.value=!1}};F(()=>{m()}),$(()=>h.value,()=>{t.value="",m()});const s=d("add"),y=d(null),x=d(),P=()=>{s.value="add",y.value=null,x.value.open()},w=o=>{s.value="eidt",y.value=o,x.value.open()},B=async o=>{const{data:_}=await _e({projectId:o});L({type:"success",message:_})},v=o=>{const _=new RegExp(`^${o.name}$`);ce.prompt("请输入·项目名称·确认删除(项目所有数据将被删除)","删除项目",{confirmButtonText:"确认",cancelButtonText:"取消",inputPattern:_,inputErrorMessage:"项目名称错误"}).then(async()=>{await B(o.id),await m()}).catch(()=>{})},t=d("");$(t,()=>{g.value=f.value.filter(o=>o.name.includes(t.value)||o.baseUrl.includes(t.value))});const r=o=>{C.push({path:`/apiList/${o.id}`})},i=d(6);F(()=>{window.addEventListener("resize",j)}),le(()=>{window.removeEventListener("resize",j)});const j=()=>{window.innerWidth>1100?i.value=6:window.innerWidth<=1100&&window.innerWidth>=750?i.value=8:i.value=12};return(o,_)=>{const u=a("el-tab-pane"),W=a("el-tabs"),G=a("el-input"),H=a("el-button"),Z=a("el-empty"),J=a("ArrowRight"),D=a("el-icon"),K=a("Delete"),O=a("Setting"),Q=a("el-card"),X=a("el-col"),Y=a("el-row"),ee=ne("loading");return b(),A("div",ge,[c("div",be,[e(W,{modelValue:h.value,"onUpdate:modelValue":_[0]||(_[0]=n=>h.value=n),"tab-position":k.value,class:"w-full h-10"},{default:l(()=>[e(u,{label:"所有项目",name:"all"}),e(u,{label:"我创建的",name:"create"}),e(u,{label:"我加入的",name:"join"})]),_:1},8,["modelValue","tab-position"]),c("div",he,[e(G,{modelValue:t.value,"onUpdate:modelValue":_[1]||(_[1]=n=>t.value=n),class:"!w-72 mr-5",placeholder:"请输入项目名称或baseUrl","suffix-icon":"Search"},null,8,["modelValue"]),e(H,{type:"primary",onClick:P},{default:l(()=>[E("新增项目")]),_:1})])]),ae((b(),A("div",xe,[g.value.length===0?(b(),U(Z,{key:0,class:"mt-40",description:"暂无数据"})):(b(),U(Y,{key:1,gutter:20},{default:l(()=>[(b(!0),A(re,null,ie(g.value,(n,te)=>(b(),U(X,{span:i.value,key:"project"+te},{default:l(()=>[e(Q,{class:"min-w-48 mb-5 cursor-pointer hover:translate-y-[-0.5rem]",shadow:"hover",onClick:S=>r(n)},{header:l(()=>[c("div",we,[c("div",ye,[c("span",{title:n.name},V(n.name),9,je)]),e(D,null,{default:l(()=>[e(J)]),_:1})])]),footer:l(()=>[c("div",Pe,[c("div",{class:"h-12 text-base flex-1 flex items-center justify-center hover:bg-gray-100",onClick:I(S=>v(n),["stop"])},[e(D,null,{default:l(()=>[e(K)]),_:1})],8,Be),c("div",{class:"h-12 text-base flex-1 flex items-center justify-center hover:bg-gray-100",onClick:I(S=>w(n),["stop"])},[e(D,null,{default:l(()=>[e(O)]),_:1})],8,De)])]),default:l(()=>[c("div",Ve,[c("p",{class:"text-e pb-1",title:n.baseUrl},V(n.baseUrl),9,Ue),c("p",{class:"text-e pb-1",title:M(q)(n.createTime)},V(M(q)(n.createTime)),9,ke),c("p",{class:"line-clamp-2 pb-1",title:n.description},V(n.description),9,Ce)])]),_:2},1032,["onClick"])]),_:2},1032,["span"]))),128))]),_:1}))])),[[ee,p.value]]),e(ve,{ref_key:"addProjectDialog",ref:x,type:s.value,info:y.value,onSuccess:m},null,8,["type","info"])],512)}}}),Se=N(Ae,[["__scopeId","data-v-4a18c481"]]);export{Se as default};
